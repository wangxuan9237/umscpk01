{% load staticfiles %}
<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <link rel="stylesheet" href="{% static 'css/bootstrap.css' %}">
    <script type="text/javascript" src="{% static 'js/jquery-3.3.1.min.js' %}"></script>
    <script type="text/javascript" src="{% static 'js/bootstrap.js' %}"></script>
</head>
<body>
<!--
<nav class="navbar navbar-inverse navbar-fixed-top">
    <div class="container">
        <div class="navbar-header">
            <a class="navbar-brand" href="#">ums产品库</a>
        </div>
        <div id="navbar" class="collapse navbar-collapse">
            <ul class="nav navbar-nav">
                <li><a href="#">1111</a></li>
                <li><a href="#">2222</a></li>
                <li><a href="#">3333</a></li>
            </ul>
        </div>
    </div>
</nav>
-->
<div class="container">
    <div class="page-header">
        <h3>UMS产品库</h3>
        <p>可以通过MCC码查询商户使用的产品</p>
    </div>
    <div class="row">
        <div class="col-md-2">
            <form class="form-group">
                <label for="mcc-code" class="sr-only">mcc code</label>
                <input type="text" class="form-control" id="mcc-code" placeholder="mcc码">
            </form>
        </div>
        <div class="col-md-2">
            <button class="btn btn-default" onclick="searchMcc()">查询</button>
        </div>
        <div class="col-md-2 col-md-offset-6">
            <button class="btn btn-default" style="float: right" data-toggle="modal" data-target="#addModal">新增</button>
            <div class="modal fade" id="addModal" tabindex="-1" role="dialog" aria-labelledby="addmodal">
                <div class="modal-dialog" role="document">
                    <div class="modal-content">
                        <div class="modal-header">
                            <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                            <h4 class="modal-title">新增</h4>
                        </div>
                        <div class="modal-body">
                            <div class="row">
                                <div class="col-md-6">
                                   <form class="form-horizontal">
                                       <div class="form-group">
                                           <label for="shanghushu" class="col-sm-4 control-label">商户数</label>
                                           <div class="col-sm-8">
                                               <input type="text" class="form-control" id="shhadd" placeholder="商户数">
                                           </div>
                                       </div>
                                       <div class="form-group">
                                           <label for="hydl" class="col-sm-4 control-label">行业大类</label>
                                           <div class="col-sm-8">
                                               <input type="text" class="form-control" id="hydladd" placeholder="行业大类">
                                           </div>
                                       </div>
                                       <div class="form-group">
                                           <label for="hyxfadd" class="col-sm-4 control-label">行业细分</label>
                                           <div class="col-sm-8">
                                               <input type="text" class="form-control" id="hyxf" placeholder="行业细分">
                                           </div>
                                       </div>
                                       <div class="form-group">
                                           <label for="mccCode" class="col-sm-4 control-label">MCC码</label>
                                           <div class="col-sm-8">
                                               <input type="text" class="form-control" id="mccCodeadd" placeholder="MCC码">
                                           </div>
                                       </div>
                                        <div class="form-group">
                                           <label for="mccName" class="col-sm-4 control-label">MCC名称</label>
                                           <div class="col-sm-8">
                                               <input type="text" class="form-control" id="mccNameadd" placeholder="MCC名称">
                                           </div>
                                       </div>
                                       <div class="form-group">
                                           <label for="product1" class="col-sm-4 control-label">产品1</label>
                                           <div class="col-sm-8">
                                               <input type="text" class="form-control" id="product1add" placeholder="产品1">
                                           </div>
                                       </div>
                                       <div class="form-group">
                                           <label for="product2" class="col-sm-4 control-label">产品2</label>
                                           <div class="col-sm-8">
                                               <input type="text" class="form-control" id="product2add" placeholder="产品2">
                                           </div>
                                       </div>
                                       <div class="form-group">
                                           <label for="product3" class="col-sm-4 control-label">产品3</label>
                                           <div class="col-sm-8">
                                               <input type="text" class="form-control" id="product3add" placeholder="产品3">
                                           </div>
                                       </div>
                                   </form>
                                </div>
                                <div class="col-md-6">
                                    <form class="form-horizontal">
                                        <div class="form-group">
                                            <label for="product4" class="col-sm-4 control-label">产品4</label>
                                            <div class="col-sm-8">
                                               <input type="text" class="form-control" id="product4add" placeholder="产品4">
                                            </div>
                                        </div>
                                        <div class="form-group">
                                            <label for="product5" class="col-sm-4 control-label">产品5</label>
                                            <div class="col-sm-8">
                                               <input type="text" class="form-control" id="product5add" placeholder="产品5">
                                            </div>
                                        </div>
                                        <div class="form-group">
                                            <label for="product6" class="col-sm-4 control-label">产品6</label>
                                            <div class="col-sm-8">
                                               <input type="text" class="form-control" id="product6add" placeholder="产品6">
                                            </div>
                                        </div>
                                        <div class="form-group">
                                            <label for="product7" class="col-sm-4 control-label">产品7</label>
                                            <div class="col-sm-8">
                                               <input type="text" class="form-control" id="product7add" placeholder="产品7">
                                            </div>
                                        </div>
                                        <div class="form-group">
                                            <label for="product8" class="col-sm-4 control-label">产品8</label>
                                            <div class="col-sm-8">
                                               <input type="text" class="form-control" id="product8add" placeholder="产品8">
                                            </div>
                                        </div>
                                        <div class="form-group">
                                            <label for="product9" class="col-sm-4 control-label">产品9</label>
                                            <div class="col-sm-8">
                                               <input type="text" class="form-control" id="product9add" placeholder="产品9">
                                            </div>
                                        </div>
                                        <div class="form-group">
                                            <label for="product10" class="col-sm-4 control-label">产品10</label>
                                            <div class="col-sm-8">
                                               <input type="text" class="form-control" id="product10add" placeholder="产品10">
                                            </div>
                                        </div>
                                    </form>
                                </div>
                            </div>

                        </div>
                        <div class="modal-footer">
                            <button type="button" class="btn btn-default" data-dismiss="modal">关闭</button>
                            <button type="button" id="addButton" class="btn btn-default" onclick="add()">保存</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="row">
        <div class="col-md-12">
            <table class="table table-striped table-bordered table-hover">
                <thead>
                <tr>
                    <th>商户数</th>
                    <th>行业大类</th>
                    <th>行业细分</th>
                    <th>MCC</th>
                    <th>MCC名称</th>
                    <th>产品1</th>
                    <th>产品2</th>
                    <th>产品3</th>
                    <th>产品4</th>
                    <th>产品5</th>
                    <th>产品6</th>
                    <th>产品7</th>
                    <th>产品8</th>
                    <th>产品9</th>
                    <th>产品10</th>
                    <th>操作</th>
                </tr>
                </thead>
                <tbody id="mcc-body">
                <!--
                <tr>
                    <td>5998</td>
                    <td>其他批发商</td>
                    <td><a href="#">银商app<a>,<a href="#">POS流水贷<a>,<a href="#">T+0结算<a></a></td>
                </tr>
                -->
                </tbody>
            </table>
            <div style="text-align: center">
                <nav aria-label="Page navigation">
                    <ul class="pagination" id="pagenav">
                        <!--
                        <li><a href="#">1</a></li>
                        <li><a href="#">2</a></li>
                        <li><a href="#">3</a></li>
                        <li><a href="#">4</a></li>
                        <li><a href="#">5</a></li>
                        -->
                    </ul>
                </nav>
            </div>
        </div>
    </div>
</div>
</body>
<script>
    $(function () {
        $.ajax({
            type:"GET",
            url:"../../static/data.json",
            dataType:"json",
            success:function (data) {
                console.log(data);
                genRow(data);
                genPageNav(data);
            },
            error:function (e) {
                console.log(e);
            }
        })
        searchMcc=function () {
            mccCode = $("#mcc-code").val();
            $.ajax({
                type:"GET",
                url:"#",
                dataType:"json",
                success:function (data) {
                    console.log(data);
                    genRow(data);
                },
                error:function (e) {
                    console.log(e);
                }
            })
        }
        pageButton=function (data) {
            $.ajax({
                type:"GET",
                url:"../../static/data01.json",
                dataType:"json",
                success:function (data) {
                    console.log(data);
                    genRow(data);
                }
            })
        }
        
        add = function () {
            var shhadd = $("#shhadd").val();
            var hydladd = $("#hydladd").val();
            var hyxfadd = $("#hyxfadd").val();
            var mccCodeadd = $("#mccCodeadd").val();
            var mccNameadd = $("#mccNameadd").val();
            var product1add = $("#product1add").val();
            var product2add = $("#product2add").val();
            var product3add = $("#product3add").val();
            var product4add = $("#product4add").val();
            var product5add = $("#product5add").val();
            var product6add = $("#product6add").val();
            var product7add = $("#product7add").val();
            var product8add = $("#product8add").val();
            var product9add = $("#product9add").val();
            var product10add = $("#product10add").val();
            $.ajax({
                type:"GET",
                url:"#",
                dataType:"json",
                data:{"shanghushu":shhadd,"hangyedalei":hydladd,"hangyexifen":hyxfadd,"num":mccCodeadd,"name":mccNameadd,
                "product1":product1add,"prodct2":product2add,
                    "product3":product3add,"product4":product4add,
                    "product5":product5add,"product6":product6add,
                    "product7":product8add,"product8":product8add,
                    "product9":product9add,"product10":product10add
                },
                success:function (data) {
                    console.log("add success");
                    console.log(data);
                },
                error:function (e) {
                    console.log("error");
                    console.log(e);
                }
            })
        }
        var genRow = function (data) {
            mcc = data;
            //每次清空table内body
            $("#mcc-body").empty();
            for(i=0;i<mcc.length;i++){
                var shanghushu = mcc[i].shanghushu;
                var hangyedalei = mcc[i].hangyedalei;
                var hangyexifen = mcc[i].hangyexifen;
                var mccCode = mcc[i].num;
                var mccName = mcc[i].name;
                var product1 = mcc[i].product1;
                var product2 = mcc[i].product2;
                var product3 = mcc[i].product3;
                var product4 = mcc[i].product4;
                var product5 = mcc[i].product5;
                var product6 = mcc[i].product6;
                var product7 = mcc[i].product7;
                var product8 = mcc[i].product8;
                var product9 = mcc[i].product9;
                var product10 = mcc[i].product10;
                var oneRow = '<tr id='+mccCode+'><td>'+shanghushu+'</td><td>'+hangyedalei+'</td><td>'+hangyexifen+'</td>'
                    +'<td>'+mccCode+'</td><td>'+mccName+'</td><td>'
                    +product1+'</td><td>'+
                        product2+'</td><td>'+
                        product3+'</td><td>'+
                        product4+'</td><td>'+
                        product5+'</td><td>'+
                        product6+'</td><td>'+
                        product7+'</td><td>'+
                        product8+'</td><td>'+
                        product9+'</td><td>'+
                        product10+'</td><td>'+
                        '<a href="#" onclick="update('+mccCode+')"><span class="glyphicon glyphicon-pencil"></span></a>' +
                    '<a href="#" onclick="del('+mccCode+')"><span class="glyphicon glyphicon-trash"></span></a>'
                    +'</td></tr>';
                $("#mcc-body").append(oneRow);
            }
        }

        del = function (mccCode) {
            $.ajax({
                url:"",
                dataType:"json",
                data:{"num":mccCode},
                success:function (data) {
                    console.log("del success");
                    console.log(data);
                },
                error:function (e) {
                    console.log(e);
                }
            })
        }
        
        update = function (mccCode) {
            trArr = $("#"+mccCode).children();
                var shsud = trArr.eq(0).text();
                $("#shhadd").val(shsud);
                var hydlud = trArr.eq(1).text();
                $("#hydladd").val(hydlud);
                var hyxfud = trArr.eq(2).text();
                $("#hyxf").val(hyxfud);
                var mcccodeud = trArr.eq(3).text();
                $("#mccCodeadd").val(mcccodeud);
                var mccnameud = trArr.eq(4).text();
                $("#mccNameadd").val(mccnameud);
                var product1 = trArr.eq(5).text();
                $("#product1add").val(product1);
                var product2 = trArr.eq(6).text();
                $("#product2add").val(product2);
                var product3 = trArr.eq(7).text();
                $("#product3add").val(product3);
                var product4 = trArr.eq(8).text();
                $("#product4add").val(product4);
                var product5 = trArr.eq(9).text();
                $("#product5add").val(product5);
                var product6 = trArr.eq(10).text();
                $("#product6add").val(product6);
                var product7 = trArr.eq(11).text();
                $("#product7add").val(product7);
                var product8 = trArr.eq(12).text();
                $("#product8add").val(product8);
                var product9 = trArr.eq(13).text();
                $("#product9add").val(product9);
                var product10 = trArr.eq(14).text();
                $("#product10add").val(product10);
                $("#addButton").attr("onclick","realupdate()");
            $("#addModal").modal("show");
        }

        realupdate = function () {
            var mcccode = $("#mccCodeadd").val();
            var product1 = $("#product1add").val();
            var product2 = $("#product2add").val();
            var product3 = $("#product3add").val();
            var product4 = $("#product4add").val();
            var product5 = $("#product5add").val();
            var product6 = $("#product6add").val();
            var product7 = $("#product7add").val();
            var product8 = $("#product8add").val();
            var product9 = $("#product9add").val();
            var product10 = $("#product10add").val();
            $.ajax({
                type:"GET",
                url:"",
                data:{"num":mcccode,"product1":product1,"product2":product2,
                "product3":product3,"product4":product4,"product5":product5,
                    "product6":product6,"product7":product7,"product8":product8,
                    "product9":product9,"product10":product10
                },
                dataType:"json",
                success:function (data) {
                    console.log("success");
                },
                error:function(e){
                    console.log(e);
                }
            })
        }

        var genPageNav = function (data) {
            for(i=1;i<=parseInt(data.pages);i++){
                var onePage = '<li><a href="#" onclick=pageButton('+i+');return false;>'+i+'</a></li>';
                $("#pagenav").append(onePage);
            }
        }
    })
</script>
</html>